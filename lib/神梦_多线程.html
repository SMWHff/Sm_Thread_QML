<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <title>按键精灵命令帮助</title>
    <script type="text/javascript" src="http://www.vrbrothers.com/cn/qmacro/qmdn/scripts/shCore.js" charset="gbk"></script>
    <link rel="stylesheet" type="text/css" href="http://www.vrbrothers.com/cn/qmacro/qmdn/css/SyntaxHighlighter.css">
    <link rel="stylesheet" type="text/css" href="http://www.vrbrothers.com/cn/qmacro/qmdn/css/help.css">
    <style>
    body{font-size:12px; font-family:Verdana,"宋体"}
    .ts{ background:#fff; margin:0 0 40px 0;}
    .ts th{ color:#7B797B; background:#DEDFDE; line-height:24px;}
    .ts td {padding:6px 0;}
    .name { font-size:16px; font-weight:bold; border-top:1px dashed #9C9A9C; border-bottom:1px dashed #9C9A9C; color:#006939;}
    .canshu { background:#E7E7EF;}
    .red{ color:#d60000;}
    .blue{ color:#0000FF;}
    .green{ color:#006939;}
    .fanhui{ border-bottom:1px dashed #9C9A9C;}
    .lizi{ border-bottom:1px dashed #9C9A9C;}
    /* Language specific styles */
    /*
      comment 为注释代码着色
      string  为字符串文字着色
      keyword 为关键字着色
      preprocessor 自定义规则着色
    */
    .dp-highlighter .comment, .dp-highlighter .comments { color: darkgreen; background-color: inherit; }
    .dp-highlighter .string { color: darkgray; background-color: inherit; }
    .dp-highlighter .keyword { color: #0000FF; font-weight: bold; background-color: inherit; }
    .dp-highlighter .preprocessor { color: #FF00FF; background-color: inherit; }
    </style>
</head>
<body>	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>模板作者：</th><td class='name'>
<a name='SMWH'></a><span Style='color:#FF00FF;'>HTML模板----神梦无痕・提供</span>
</td></tr><tr><th>功能说明：</th><td>
<span Style='color:#006939;'>本文件通过《神梦命令帮助编辑器》编辑制作完成！</span>
</td></tr><tr><th>联系方式：</th><td class='canshu'><pre>
联系QQ：<a href="tencent://message/?Menu=yes&uin=1042207232&Service=300&sigT=45a1e5847943b64c6ff3990f8a9e644d2b31356cb0b4ac6b24663a3c8dd0f8aa12a595b1714f9d45" alt="神梦无痕" title="神梦无痕"><U>1042207232</U></a><br>
交流Q群：<a target="_blank" href="http://shang.qq.com/wpa/qunwpa?idkey=c2a1d4064a19ccc5a1ee4d05b5608e164c9371f4589aab48f73e291f6a1295cd"><img border="0" src="http://pub.idqqimg.com/wpa/images/group.png" alt="按键易语言TC放单群 584781753" title="按键易语言TC放单群 584781753"></a>
</td></tr><tr><th>业务范围：</th><td class='fanhui'>
<span Style='color:#0000FF;'><B>专业定制PC，安卓，苹果，模拟器，办公，Post注册等模拟操作，解放双手，轻松搞定！</B></span>
</td></tr><tr><th>脚本例子：<br /><span class='red'>(8.x语法)</span>
</th><td class='lizi'><pre name="code8_SMWH" class="vb" id="code8_SMWH">
无
</td></tr></table>	



<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='_初始化'></a>_初始化 
</td></tr><tr><th>命令功能：</th><td>
初始化命令库，使用前必须调用该命令。（脚本开头初始化一次就行）
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
返回值：逻辑型，是否成功
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8__初始化" class="vb" id="code8__初始化">
'===============【100个线程并发计数】===============
'  作者：神梦无痕
'  ＱＱ：1042207232
'　Ｑ群：624655641
'==================================================

DimEnv 互斥锁, 事件锁, 自旋锁, 多线程_计数

//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()


//=========================演示互斥锁=========================
多线程_计数 = 0
t = Timer()
TracePrint "开始演示多线程中使用【互斥锁】。。。"
'创建互斥体锁
互斥锁 = Lib.神梦_多线程.互斥锁创建()
For 100
    BeginThread 多线程_互斥
Next
While 多线程_计数 < 10000
Wend
'销毁互斥体锁  
Call Lib.神梦_多线程.互斥锁销毁(互斥锁)
提示 = "多线程中使用【互斥锁】计数10000次耗时：" & Timer() - t & " 秒"
MsgBox 提示, 64+4096, "【互斥锁】"  : TracePrint 提示


//=========================演示事件锁=========================
多线程_计数 = 0
t = Timer()
TracePrint "开始演示多线程中使用【事件锁】。。。"
'创建事件
事件锁 = Lib.神梦_多线程.事件创建()
For 100
    BeginThread 多线程_事件
Next
While 多线程_计数 < 10000
Wend
'销毁事件锁 
Call Lib.神梦_多线程.事件销毁(事件锁)
提示 = "多线程中使用【事件锁】计数10000次耗时：" & Timer() - t & " 秒"
MsgBox 提示, 64+4096, "【事件锁】"  : TracePrint 提示


//=========================演示自旋锁=========================
多线程_计数 = 0
t = Timer()
TracePrint "开始演示多线程中使用【自旋锁】。。。"
'创建自旋锁   
自旋锁 = Lib.神梦_多线程.自旋锁创建()  
For 100
    BeginThread 多线程_自旋
Next
While 多线程_计数 < 10000
Wend
'自旋锁不需要销毁操作
提示 = "多线程中使用【自旋锁】计数10000次耗时：" & Timer() - t & " 秒"
MsgBox 提示, 64+4096, "【自旋锁】"  : TracePrint 提示

Sub 多线程_互斥()
	'  作者：神梦无痕
	'  ＱＱ：1042207232
	'　Ｑ群：624655641
    Call Lib.神梦_多线程.互斥锁进入(互斥锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.互斥锁退出(互斥锁)'退出要跟进入许可区配对使用。
End Sub
Sub 多线程_事件()
	'  作者：神梦无痕
	'  ＱＱ：1042207232
	'　Ｑ群：624655641
    Call Lib.神梦_多线程.事件进入(事件锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.事件退出(事件锁)'退出要跟进入许可区配对使用。
End Sub
Sub 多线程_自旋()
	'  作者：神梦无痕
	'  ＱＱ：1042207232
	'　Ｑ群：624655641
    Call Lib.神梦_多线程.自旋锁进入(自旋锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.自旋锁退出(自旋锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='读写锁创建'></a>读写锁创建 
</td></tr><tr><th>命令功能：</th><td>
创建读写锁。成功返回读写锁指针。失败返回0
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
整数型，对象句柄
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_读写锁创建" class="vb" id="code8_读写锁创建">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 读写句柄, 多线程_计数

多线程_计数 = 0
读写句柄 = Lib.神梦_多线程.读写锁创建()
BeginThread 多线程_读
BeginThread 多线程_写
Do
    Delay 3000
Loop


Sub 多线程_读()
    Do
        Call Lib.神梦_多线程.读写锁读锁定(读写句柄)
        TracePrint 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 300
    Loop 
End Sub
Sub 多线程_写()
    Do
        Call Lib.神梦_多线程.读写锁写锁定(读写句柄)
        多线程_计数 = 多线程_计数 + 1
        TracePrint "【写入】：" & 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 1000
    Loop 
End Sub


//以下是当脚本【全部停止时】产生的事件   
Sub OnScriptExit()   
    Call Lib.神梦_多线程.读写锁销毁(读写句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='读写锁读锁定'></a>读写锁读锁定 
</td></tr><tr><th>命令功能：</th><td>
进入读锁。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_读写锁读锁定" class="vb" id="code8_读写锁读锁定">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 读写句柄, 多线程_计数

多线程_计数 = 0
读写句柄 = Lib.神梦_多线程.读写锁创建()
BeginThread 多线程_读
BeginThread 多线程_写
Do
    Delay 3000
Loop


Sub 多线程_读()
    Do
        Call Lib.神梦_多线程.读写锁读锁定(读写句柄)
        TracePrint 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 300
    Loop 
End Sub
Sub 多线程_写()
    Do
        Call Lib.神梦_多线程.读写锁写锁定(读写句柄)
        多线程_计数 = 多线程_计数 + 1
        TracePrint "【写入】：" & 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 1000
    Loop 
End Sub


//以下是当脚本【全部停止时】产生的事件   
Sub OnScriptExit()   
    Call Lib.神梦_多线程.读写锁销毁(读写句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='读写锁解锁'></a>读写锁解锁 
</td></tr><tr><th>命令功能：</th><td>
退出读/写锁。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_读写锁解锁" class="vb" id="code8_读写锁解锁">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 读写句柄, 多线程_计数

多线程_计数 = 0
读写句柄 = Lib.神梦_多线程.读写锁创建()
BeginThread 多线程_读
BeginThread 多线程_写
Do
    Delay 3000
Loop


Sub 多线程_读()
    Do
        Call Lib.神梦_多线程.读写锁读锁定(读写句柄)
        TracePrint 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 300
    Loop 
End Sub
Sub 多线程_写()
    Do
        Call Lib.神梦_多线程.读写锁写锁定(读写句柄)
        多线程_计数 = 多线程_计数 + 1
        TracePrint "【写入】：" & 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 1000
    Loop 
End Sub


//以下是当脚本【全部停止时】产生的事件   
Sub OnScriptExit()   
    Call Lib.神梦_多线程.读写锁销毁(读写句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='读写锁销毁'></a>读写锁销毁 
</td></tr><tr><th>命令功能：</th><td>
销毁读写锁。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_读写锁销毁" class="vb" id="code8_读写锁销毁">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 读写句柄, 多线程_计数

多线程_计数 = 0
读写句柄 = Lib.神梦_多线程.读写锁创建()
BeginThread 多线程_读
BeginThread 多线程_写
Do
    Delay 3000
Loop


Sub 多线程_读()
    Do
        Call Lib.神梦_多线程.读写锁读锁定(读写句柄)
        TracePrint 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 300
    Loop 
End Sub
Sub 多线程_写()
    Do
        Call Lib.神梦_多线程.读写锁写锁定(读写句柄)
        多线程_计数 = 多线程_计数 + 1
        TracePrint "【写入】：" & 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 1000
    Loop 
End Sub


//以下是当脚本【全部停止时】产生的事件   
Sub OnScriptExit()   
    Call Lib.神梦_多线程.读写锁销毁(读写句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='读写锁写锁定'></a>读写锁写锁定 
</td></tr><tr><th>命令功能：</th><td>
进入写锁。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_读写锁写锁定" class="vb" id="code8_读写锁写锁定">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 读写句柄, 多线程_计数

多线程_计数 = 0
读写句柄 = Lib.神梦_多线程.读写锁创建()
BeginThread 多线程_读
BeginThread 多线程_写
Do
    Delay 3000
Loop


Sub 多线程_读()
    Do
        Call Lib.神梦_多线程.读写锁读锁定(读写句柄)
        TracePrint 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 300
    Loop 
End Sub
Sub 多线程_写()
    Do
        Call Lib.神梦_多线程.读写锁写锁定(读写句柄)
        多线程_计数 = 多线程_计数 + 1
        TracePrint "【写入】：" & 多线程_计数
        Call Lib.神梦_多线程.读写锁解锁(读写句柄)
        Delay 1000
    Loop 
End Sub


//以下是当脚本【全部停止时】产生的事件   
Sub OnScriptExit()   
    Call Lib.神梦_多线程.读写锁销毁(读写句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='互斥锁创建'></a>互斥锁创建 
</td></tr><tr><th>命令功能：</th><td>
创建一个互斥量。成功返回互斥量对象句柄，失败返回0 。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
整数型，对象句柄
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_互斥锁创建" class="vb" id="code8_互斥锁创建">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建互斥体锁
线程锁 = Lib.神梦_多线程.互斥锁创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等所有线程执行完毕后，记得销毁【线程锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
'销毁互斥体锁
Call Lib.神梦_多线程.互斥锁销毁(锁句柄)


Sub 多线程()
    Call Lib.神梦_多线程.互斥锁进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.互斥锁退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='互斥锁进入'></a>互斥锁进入 
</td></tr><tr><th>命令功能：</th><td>
等待并进入/拥有这个互斥量。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_互斥锁进入" class="vb" id="code8_互斥锁进入">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建互斥体锁
线程锁 = Lib.神梦_多线程.互斥锁创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等所有线程执行完毕后，记得销毁【线程锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
'销毁互斥体锁
Call Lib.神梦_多线程.互斥锁销毁(锁句柄)


Sub 多线程()
    Call Lib.神梦_多线程.互斥锁进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.互斥锁退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='互斥锁退出'></a>互斥锁退出 
</td></tr><tr><th>命令功能：</th><td>
退出/释放这个互斥量。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_互斥锁退出" class="vb" id="code8_互斥锁退出">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建互斥体锁
线程锁 = Lib.神梦_多线程.互斥锁创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等所有线程执行完毕后，记得销毁【线程锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
'销毁互斥体锁
Call Lib.神梦_多线程.互斥锁销毁(锁句柄)


Sub 多线程()
    Call Lib.神梦_多线程.互斥锁进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.互斥锁退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='互斥锁销毁'></a>互斥锁销毁 
</td></tr><tr><th>命令功能：</th><td>
销毁指定互斥量对象
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_互斥锁销毁" class="vb" id="code8_互斥锁销毁">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建互斥体锁
线程锁 = Lib.神梦_多线程.互斥锁创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等所有线程执行完毕后，记得销毁【线程锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
'销毁互斥体锁
Call Lib.神梦_多线程.互斥锁销毁(锁句柄)


Sub 多线程()
    Call Lib.神梦_多线程.互斥锁进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.互斥锁退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='临界区创建'></a>临界区创建 
</td></tr><tr><th>命令功能：</th><td>
创建一个临界许可。创建成功返回许可证，失败返回0
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
整数型，许可证
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_临界区创建" class="vb" id="code8_临界区创建">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 许可证, 多线程_计数

'创建临界许可
许可证 = Lib.神梦_多线程.临界区创建()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【许可证】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.临界区销毁(许可证)

Sub 多线程()
    Call Lib.神梦_多线程.临界区进入(许可证)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.临界区退出(许可证) '退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='临界区进入'></a>临界区进入 
</td></tr><tr><th>命令功能：</th><td>
等待并进入/拥有这个临界许可
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，许可证
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_临界区进入" class="vb" id="code8_临界区进入">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 许可证, 多线程_计数

'创建临界许可
许可证 = Lib.神梦_多线程.临界区创建()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【许可证】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.临界区销毁(许可证)

Sub 多线程()
    Call Lib.神梦_多线程.临界区进入(许可证)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.临界区退出(许可证) '退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='临界区退出'></a>临界区退出 
</td></tr><tr><th>命令功能：</th><td>
退出/释放这个许可证
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，许可证
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_临界区退出" class="vb" id="code8_临界区退出">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 许可证, 多线程_计数

'创建临界许可
许可证 = Lib.神梦_多线程.临界区创建()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【许可证】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.临界区销毁(许可证)

Sub 多线程()
    Call Lib.神梦_多线程.临界区进入(许可证)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.临界区退出(许可证) '退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='临界区销毁'></a>临界区销毁 
</td></tr><tr><th>命令功能：</th><td>
销毁指定许可证。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，许可证
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_临界区销毁" class="vb" id="code8_临界区销毁">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 许可证, 多线程_计数

'创建临界许可
许可证 = Lib.神梦_多线程.临界区创建()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【许可证】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.临界区销毁(许可证)

Sub 多线程()
    Call Lib.神梦_多线程.临界区进入(许可证)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.临界区退出(许可证) '退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='事件创建'></a>事件创建 
</td></tr><tr><th>命令功能：</th><td>
创建一个 Event事件对象。创建成功返回对象句柄，失败返回0 。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
整数型，对象句柄
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_事件创建" class="vb" id="code8_事件创建">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建事件
线程锁 = Lib.神梦_多线程.事件创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【线程锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.事件销毁(线程锁)

Sub 多线程()
    Call Lib.神梦_多线程.事件进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.事件退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='事件进入'></a>事件进入 
</td></tr><tr><th>命令功能：</th><td>
等待并进入/拥有这个Event事件对象。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_事件进入" class="vb" id="code8_事件进入">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建事件
线程锁 = Lib.神梦_多线程.事件创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【线程锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.事件销毁(线程锁)

Sub 多线程()
    Call Lib.神梦_多线程.事件进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.事件退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='事件退出'></a>事件退出 
</td></tr><tr><th>命令功能：</th><td>
退出/释放这个Event事件对象。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_事件退出" class="vb" id="code8_事件退出">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建事件
线程锁 = Lib.神梦_多线程.事件创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【线程锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.事件销毁(线程锁)

Sub 多线程()
    Call Lib.神梦_多线程.事件进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.事件退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='事件销毁'></a>事件销毁 
</td></tr><tr><th>命令功能：</th><td>
销毁指定Event事件对象。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_事件销毁" class="vb" id="code8_事件销毁">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建事件
线程锁 = Lib.神梦_多线程.事件创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【线程锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.事件销毁(线程锁)

Sub 多线程()
    Call Lib.神梦_多线程.事件进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.事件退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='线程_挂起'></a>线程_挂起 
</td></tr><tr><th>命令功能：</th><td>
暂停某个线程的运行（PauseThread）
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，线程ID编号
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_线程_挂起" class="vb" id="code8_线程_挂起">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()


线程ID=BeginThread(测试) //启动“测试”线程，并返回线程ID编号
For 3 
    Delay 1000
Next
Call Lib.神梦_多线程.线程_挂起(线程ID) //等待3秒后暂停“测试”线程的运行
For 5
    Delay 1000
Next
Call Lib.神梦_多线程.线程_恢复(线程ID) //等待5秒后继续“测试”线程的运行
For 3
    Delay 1000
Next
ExitScript //等待3秒后停止并退出脚本运行
Sub 测试()
    i=0
    Do 
        TracePrint i
        Delay 1000
        i=i+1
    Loop 
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='线程_恢复'></a>线程_恢复 
</td></tr><tr><th>命令功能：</th><td>
继续某个线程的运行（ContinueThread）
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，线程ID编号
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_线程_恢复" class="vb" id="code8_线程_恢复">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()


线程ID=BeginThread(测试) //启动“测试”线程，并返回线程ID编号
For 3 
    Delay 1000
Next
Call Lib.神梦_多线程.线程_挂起(线程ID) //等待3秒后暂停“测试”线程的运行
For 5
    Delay 1000
Next
Call Lib.神梦_多线程.线程_恢复(线程ID) //等待5秒后继续“测试”线程的运行
For 3
    Delay 1000
Next
ExitScript //等待3秒后停止并退出脚本运行
Sub 测试()
    i=0
    Do 
        TracePrint i
        Delay 1000
        i=i+1
    Loop 
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='线程_结束'></a>线程_结束 
</td></tr><tr><th>命令功能：</th><td>
停止某个线程的运行（StopThread）
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，线程ID编号
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_线程_结束" class="vb" id="code8_线程_结束">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()


线程ID = BeginThread(测试)//启动“测试”线程的运行
For 3
    Delay 1000
Next
Call Lib.神梦_多线程.线程_结束(线程ID)//3秒后停止“测试”线程的运行
Sub 测试()
    i=0
    Do 
        TracePrint i
        Delay 1000
        i = i + 1
    Loop 
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='线程_取当前ID'></a>线程_取当前ID 
</td></tr><tr><th>命令功能：</th><td>
得到当前线程的ID（GetThreadID）
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
整数型，线程ID
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_线程_取当前ID" class="vb" id="code8_线程_取当前ID">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()


//对多线程返回的线程ID号，需要定义环境变量
DimEnv 线程ID1, 线程ID2
线程ID1 = BeginThread(子程序1)
线程ID2 = BeginThread(子程序2)

//以下是【测试用】子程序例子
Dim i
Sub 子程序1()
    i=1 
    TracePrint "子程序被线程启动！" & i  
End Sub
Sub 子程序2()
    i=2
    TracePrint "子程序被线程启动！" & i 
End Sub

//以下是【无限循环】防止全部脚本停止。
Do 
    Delay 1000
Loop

//以下是只对【多线程停止时】产生的事件 
Sub OnThreadExit()
    Dim ThreadID
    ThreadID = Lib.神梦_多线程.线程_取当前ID() //得到当前线程的ID
    Select Case ThreadID
    Case 线程ID1 
        //这样就可以针对某个线程进行操作
        //比如：释放大漠插件对象
        TracePrint i & " 当前线程(" & ThreadID & ")已经停止！" & 线程ID1  
    Case 线程ID2
        //这样就可以针对某个线程进行操作
        //比如：释放361插件对象     
        TracePrint i & " 当前线程(" & ThreadID & ")已经停止！" & 线程ID2 
    End Select
End Sub

//以下是当脚本【全部停止时】产生的事件
Sub OnScriptExit()
    MessageBox "脚本已经停止！"
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='线程_取状态'></a>线程_取状态 
</td></tr><tr><th>命令功能：</th><td>
获取某个线程的运行状态。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，线程ID编号
</td></tr><tr><th>返回值：</th><td class='fanhui'>
整数型，运行状态，0=线程已结束；1=线程正在运行；-1=线程句柄已失效或销毁
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_线程_取状态" class="vb" id="code8_线程_取状态">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()


TracePrint "【状态】：" & Lib.神梦_多线程.线程_取状态(线程ID) '返回 -1 无效线程句柄
线程ID=BeginThread(测试) //启动“测试”线程，并返回线程ID编号
For 3 
    Delay 1000
Next
TracePrint "【状态】：" & Lib.神梦_多线程.线程_取状态(线程ID) '返回 1 线程正在运行
Call Lib.神梦_多线程.线程_挂起(线程ID) //等待3秒后暂停“测试”线程的运行
For 5
    Delay 1000
Next
TracePrint "【状态】：" & Lib.神梦_多线程.线程_取状态(线程ID) '返回 1 线程正在运行
Call Lib.神梦_多线程.线程_恢复(线程ID) //等待5秒后继续“测试”线程的运行
For 3
    Delay 1000
Next
Call Lib.神梦_多线程.线程_结束(线程ID)//等待3秒后停止“测试”线程的运行
Delay 2000
TracePrint "【状态】：" & Lib.神梦_多线程.线程_取状态(线程ID) '返回 0 线程已结束
ExitScript //等待3秒后停止并退出脚本运行
Sub 测试()
    i=0
    Do 
        TracePrint i
        Delay 1000
        i=i+1
    Loop 
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='信号量创建'></a>信号量创建 
</td></tr><tr><th>命令功能：</th><td>
创建一个信号量。多用于控制线程数量。成功返回信号量句柄，失败返回0
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，并发上限，用于控制线程数量。
</td></tr><tr><th>返回值：</th><td class='fanhui'>
整数型，对象句柄
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_信号量创建" class="vb" id="code8_信号量创建">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()


DimEnv 信号句柄, 运行计次

//创建信号量，并发上限设置为5
信号句柄 = Lib.神梦_多线程.信号量创建(5)


For 运行计次 = 1 To 100
    BeginThread 多线程(运行计次)
    Delay 500 '线程数越多，这里的延迟要越大
Next
Do
	Delay 1000
Loop Until Lib.神梦_多线程.信号量是否空闲(信号句柄)
'销毁信号量
Call Lib.神梦_多线程.信号量销毁(信号句柄)
MsgBox "运行完毕！", 64 + 4096, "温馨提示！"


Sub 多线程(参数)
    i = 参数'重新赋值新变量，以免被其他线程影响
    Call Lib.神梦_多线程.信号量等待(信号句柄)
    
    //以下写入你自己的代码
    TracePrint "【" & i & "】开始运行。。。"
    Delay 5000
End Sub

//以下是只对【多线程停止时】产生的事件   
Sub OnThreadExit()
    TracePrint "【" & i & "】结束！"
    Call Lib.神梦_多线程.信号量释放(信号句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='信号量等待'></a>信号量等待 
</td></tr><tr><th>命令功能：</th><td>
等待并进入/拥有这个信号对象，当运行的线程数等于创建时设置的并发上限，其他线程将全部挂起等待
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_信号量等待" class="vb" id="code8_信号量等待">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 信号句柄, 运行计次

//创建信号量，并发上限设置为5
信号句柄 = Lib.神梦_多线程.信号量创建(5)


For 运行计次 = 1 To 100
    BeginThread 多线程(运行计次)
    Delay 500 '线程数越多，这里的延迟要越大
Next
Do
	Delay 1000
Loop Until Lib.神梦_多线程.信号量是否空闲(信号句柄)
'销毁信号量
Call Lib.神梦_多线程.信号量销毁(信号句柄)
MsgBox "运行完毕！", 64 + 4096, "温馨提示！"


Sub 多线程(参数)
    i = 参数'重新赋值新变量，以免被其他线程影响
    Call Lib.神梦_多线程.信号量等待(信号句柄)
    
    //以下写入你自己的代码
    TracePrint "【" & i & "】开始运行。。。"
    Delay 5000
End Sub

//以下是只对【多线程停止时】产生的事件   
Sub OnThreadExit()
    TracePrint "【" & i & "】结束！"
    Call Lib.神梦_多线程.信号量释放(信号句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='信号量是否空闲'></a>信号量是否空闲 
</td></tr><tr><th>命令功能：</th><td>
判断指定信号量是否有线程正在运行。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
逻辑型，是否空闲
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_信号量是否空闲" class="vb" id="code8_信号量是否空闲">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 信号句柄, 运行计次

//创建信号量，并发上限设置为5
信号句柄 = Lib.神梦_多线程.信号量创建(5)


For 运行计次 = 1 To 100
    BeginThread 多线程(运行计次)
    Delay 500 '线程数越多，这里的延迟要越大
Next
Do
	Delay 1000
Loop Until Lib.神梦_多线程.信号量是否空闲(信号句柄)
'销毁信号量
Call Lib.神梦_多线程.信号量销毁(信号句柄)
MsgBox "运行完毕！", 64 + 4096, "温馨提示！"


Sub 多线程(参数)
    i = 参数'重新赋值新变量，以免被其他线程影响
    Call Lib.神梦_多线程.信号量等待(信号句柄)
    
    //以下写入你自己的代码
    TracePrint "【" & i & "】开始运行。。。"
    Delay 5000
End Sub

//以下是只对【多线程停止时】产生的事件   
Sub OnThreadExit()
    TracePrint "【" & i & "】结束！"
    Call Lib.神梦_多线程.信号量释放(信号句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='信号量释放'></a>信号量释放 
</td></tr><tr><th>命令功能：</th><td>
退出/释放当前占用的信号量，让其他线程可以进入。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_信号量释放" class="vb" id="code8_信号量释放">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 信号句柄, 运行计次

//创建信号量，并发上限设置为5
信号句柄 = Lib.神梦_多线程.信号量创建(5)


For 运行计次 = 1 To 100
    BeginThread 多线程(运行计次)
    Delay 500 '线程数越多，这里的延迟要越大
Next
Do
	Delay 1000
Loop Until Lib.神梦_多线程.信号量是否空闲(信号句柄)
'销毁信号量
Call Lib.神梦_多线程.信号量销毁(信号句柄)
MsgBox "运行完毕！", 64 + 4096, "温馨提示！"


Sub 多线程(参数)
    i = 参数'重新赋值新变量，以免被其他线程影响
    Call Lib.神梦_多线程.信号量等待(信号句柄)
    
    //以下写入你自己的代码
    TracePrint "【" & i & "】开始运行。。。"
    Delay 5000
End Sub

//以下是只对【多线程停止时】产生的事件   
Sub OnThreadExit()
    TracePrint "【" & i & "】结束！"
    Call Lib.神梦_多线程.信号量释放(信号句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='信号量销毁'></a>信号量销毁 
</td></tr><tr><th>命令功能：</th><td>
销毁指定信号量。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_信号量销毁" class="vb" id="code8_信号量销毁">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 信号句柄, 运行计次

//创建信号量，并发上限设置为5
信号句柄 = Lib.神梦_多线程.信号量创建(5)


For 运行计次 = 1 To 100
    BeginThread 多线程(运行计次)
    Delay 500 '线程数越多，这里的延迟要越大
Next
Do
	Delay 1000
Loop Until Lib.神梦_多线程.信号量是否空闲(信号句柄)
'销毁信号量
Call Lib.神梦_多线程.信号量销毁(信号句柄)
MsgBox "运行完毕！", 64 + 4096, "温馨提示！"


Sub 多线程(参数)
    i = 参数'重新赋值新变量，以免被其他线程影响
    Call Lib.神梦_多线程.信号量等待(信号句柄)
    
    //以下写入你自己的代码
    TracePrint "【" & i & "】开始运行。。。"
    Delay 5000
End Sub

//以下是只对【多线程停止时】产生的事件   
Sub OnThreadExit()
    TracePrint "【" & i & "】结束！"
    Call Lib.神梦_多线程.信号量释放(信号句柄)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_初始化'></a>原子_初始化 
</td></tr><tr><th>命令功能：</th><td>
原子锁初始化。多用于解决整数型变量赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_初始化" class="vb" id="code8_原子_初始化">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_计数

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【原子锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.原子_销毁()

Sub 多线程()
    For 100
        '将环境变量名【多线程_计数】以字符串传入
        Call Lib.神梦_多线程.原子_递增("多线程_计数")
    Next
    TracePrint 多线程_计数
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_递减'></a>原子_递减 
</td></tr><tr><th>命令功能：</th><td>
递减参数的值。对提供的整数型变量-1。多线程中使用可避免赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：文本型，环境变量名称
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_递减" class="vb" id="code8_原子_递减">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_计数

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_计数 = 10000
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【原子锁】！" & vbCrLf & "输出 0 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.原子_销毁()

Sub 多线程()
    For 100
        '将环境变量名【多线程_计数】以字符串传入
        Call Lib.神梦_多线程.原子_递减("多线程_计数")
    Next
    TracePrint 多线程_计数
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_递增'></a>原子_递增 
</td></tr><tr><th>命令功能：</th><td>
递增参数的值。对提供的整数型变量+1。多线程中使用可避免赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：文本型，环境变量名称
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_递增" class="vb" id="code8_原子_递增">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_计数

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【原子锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.原子_销毁()

Sub 多线程()
    For 100
        '将环境变量名【多线程_计数】以字符串传入
        Call Lib.神梦_多线程.原子_递增("多线程_计数")
    Next
    TracePrint 多线程_计数
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_调试输出'></a>原子_调试输出 
</td></tr><tr><th>命令功能：</th><td>
调试输出内容，按键精灵的调试是共享资源。多线程中使用可避免赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：文本型，调试内容
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_调试输出" class="vb" id="code8_原子_调试输出">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_计数

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next

//达到 10000 表示执行完毕！
Do
    Delay 3000
Loop Until 多线程_计数 >= 10000

//所有线程执行完毕后，记得销毁【原子锁】！
Call Lib.神梦_多线程.原子_销毁()

MsgBox "脚本执行完毕！", 4096, "温馨提示！"

Sub 多线程()
    For 100
        '将环境变量名【多线程_计数】以字符串传入
        Call Lib.神梦_多线程.原子_递增("多线程_计数")
    Next
    Call Lib.神梦_多线程.原子_调试输出(多线程_计数)
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_赋值'></a>原子_赋值 
</td></tr><tr><th>命令功能：</th><td>
赋值参数的值。对提供的整数型变量赋值。多线程中使用可避免赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：文本型，环境变量名称
参数2【必选】：数值型，赋值
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_赋值" class="vb" id="code8_原子_赋值">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_计数

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【原子锁】！" & vbCrLf & "输出 100 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.原子_销毁()

Sub 多线程()
    Dim i
    For i = 1 To 100
        '将环境变量名【多线程_计数】以字符串传入
        Call Lib.神梦_多线程.原子_赋值("多线程_计数", i)
    Next
    TracePrint 多线程_计数
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_交换'></a>原子_交换 
</td></tr><tr><th>命令功能：</th><td>
交换参数的值。对提供的参数变量进行值交换。多线程中使用可避免赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：文本型，环境变量一名称
参数2【必选】：文本型，环境变量二名称
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_交换" class="vb" id="code8_原子_交换">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_变量, 多线程_新变量

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_变量 = "神梦无痕"
多线程_新变量 = "SMWH"
For 99
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【原子锁】！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.原子_销毁()

Sub 多线程()
    '将环境变量名【多线程_变量】【多线程_新变量】以字符串传入
    Call Lib.神梦_多线程.原子_交换("多线程_变量", "多线程_新变量")
    TracePrint 多线程_变量 & " " & 多线程_新变量
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_三目运算'></a>原子_三目运算 
</td></tr><tr><th>命令功能：</th><td>
运算参数的数值。对提供的整数型变量进行三目运算。多线程中使用可避免赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：文本型，环境变量名称
参数2【必选】：数值型，赋值
参数3【必选】：数值型，对比值
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_三目运算" class="vb" id="code8_原子_三目运算">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_计数

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_计数 = 0
For 111
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【原子锁】！" & vbCrLf & "输出大于 300 表示执行成功！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.原子_销毁()

Sub 多线程()
    '将环境变量名【多线程_计数】以字符串传入
    多线程_计数 = 多线程_计数 + 1
    Call Lib.神梦_多线程.原子_三目运算("多线程_计数", 300, 99) '如果【多线程_计数】 = 99 则，【多线程_计数】赋值为300
    TracePrint 多线程_计数
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_销毁'></a>原子_销毁 
</td></tr><tr><th>命令功能：</th><td>
原子锁销毁。多用于解决整数型变量赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_销毁" class="vb" id="code8_原子_销毁">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_计数

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【原子锁】！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.原子_销毁()

Sub 多线程()
    For 100
        '将环境变量名【多线程_计数】以字符串传入
        Call Lib.神梦_多线程.原子_递增("多线程_计数")
    Next
    TracePrint 多线程_计数
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='原子_运算'></a>原子_运算 
</td></tr><tr><th>命令功能：</th><td>
运算参数的数值。对提供的整数型变量进行运算。多线程中使用可避免赋值冲突。
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：文本型，环境变量名称
参数2【必选】：数值型，运算值，支持正负号
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_原子_运算" class="vb" id="code8_原子_运算">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 多线程_计数

'原子锁初始化
Call Lib.神梦_多线程.原子_初始化()

多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕后，记得销毁【原子锁】！" & vbCrLf & "输出 0 表示执行完毕！", 64 + 4096, "温馨提示！"
Call Lib.神梦_多线程.原子_销毁()

Sub 多线程()
    For 100
        '将环境变量名【多线程_计数】以字符串传入
		Call Lib.神梦_多线程.原子_运算("多线程_计数", +2) '计数加2
		Call Lib.神梦_多线程.原子_运算("多线程_计数", -2) '计数减2
    Next
    TracePrint 多线程_计数
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='自旋锁创建'></a>自旋锁创建 
</td></tr><tr><th>命令功能：</th><td>
创建一个自旋对象
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
无
</td></tr><tr><th>返回值：</th><td class='fanhui'>
整数型，对象句柄
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_自旋锁创建" class="vb" id="code8_自旋锁创建">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建自旋锁
线程锁 = Lib.神梦_多线程.自旋锁创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
'自旋锁不需要销毁操作

Sub 多线程()
    Call Lib.神梦_多线程.自旋锁进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.自旋锁退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='自旋锁进入'></a>自旋锁进入 
</td></tr><tr><th>命令功能：</th><td>
等待并进入/拥有这个自旋对象
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_自旋锁进入" class="vb" id="code8_自旋锁进入">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建自旋锁
线程锁 = Lib.神梦_多线程.自旋锁创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
'自旋锁不需要销毁操作

Sub 多线程()
    Call Lib.神梦_多线程.自旋锁进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.自旋锁退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<table width='100%' border='0' cellpadding='0' cellspacing='1' class='ts'>
<tr><th width='100px'>命令名称：</th><td class='name'>
<a name='自旋锁退出'></a>自旋锁退出 
</td></tr><tr><th>命令功能：</th><td>
退出/释放这个自旋对象
</td></tr><tr><th>命令参数：</th><td class='canshu'><pre>
参数1【必选】：整数型，对象句柄
</td></tr><tr><th>返回值：</th><td class='fanhui'>
无
</td></tr><tr><th><span class='red'>脚本例子：</span>
</th><td class='lizi'><pre name="code8_自旋锁退出" class="vb" id="code8_自旋锁退出">
//初始化命令库，使用前必须调用该命令
Call Lib.神梦_多线程._初始化()

DimEnv 线程锁, 多线程_计数

'创建自旋锁
线程锁 = Lib.神梦_多线程.自旋锁创建()
多线程_计数 = 0
For 100
    BeginThread 多线程
Next
MsgBox "等待所有线程执行完毕！" & vbCrLf & "输出 10000 表示执行完毕！", 64 + 4096, "温馨提示！"
'自旋锁不需要销毁操作

Sub 多线程()
    Call Lib.神梦_多线程.自旋锁进入(线程锁)
    '以下 进入许可区后，要操作的功能函数代码
    For 100
        多线程_计数 = 多线程_计数 + 1
    Next
    TracePrint 多线程_计数
    Call Lib.神梦_多线程.自旋锁退出(线程锁)'退出要跟进入许可区配对使用。
End Sub
</td></tr></table>	
	
	


<script type="text/javascript">
    dp.sh.Brushes.Vb = function()
    { 
        var keywords = 'vbBlack vbRed vbGreen vbYellow vbBlue vbMagenta vbCyan vbWhite vbBinaryCompare vbTextCompare vbSunday vbMonday vbTuesday vbWednesday ' + 
        'vbThursday vbFriday vbSaturday vbUseSystemDayOfWeek vbFirstJan1 vbFirstFourDays vbFirstFullWeek vbGeneralDate vbLongDate vbShortDate vbLongTime ' + 
        'vbShortTime vbObjectError vbOKOnly vbOKCancel vbAbortRetryIgnore vbYesNoCancel vbYesNo vbRetryCancel vbCritical vbQuestion vbExclamation vbInformation ' + 
        'vbDefaultButton1 vbDefaultButton2 vbDefaultButton3 vbDefaultButton4 vbApplicationModal vbSystemModal vbOK vbCancel vbAbort vbRetry vbIgnore vbYes vbNo '+
        'vbCr vbCrLf vbFormFeed vbLf vbNewLine vbNullChar vbNullString vbTab vbVerticalTab vbUseDefault vbTrue vbFalse vbEmpty vbNull vbInteger vbLong vbSingle '+
        'vbDouble vbCurrency vbDate vbString vbObject vbError vbBoolean vbVariant vbDataObject vbDecimal vbByte vbArray WScript '+
        'And As Boolean ByRef Byte ByVal Call Case Const Currency Debug Dim Do Double Each Else ElseIf Empty End EndIf Enum Eqv Event Exit Explicit False For '+ 
        'Function Get Goto If Imp Implements In Integer Is Let Like Long Loop LSet Me Mod New Next Not Nothing Null On Option Optional Or ParamArray Preserve '+
        'Private Property Public RaiseEvent ReDim Rem Resume RSet Select Set Shared Single Static Stop Sub Then To True Type TypeOf Until Variant Wend While With '+
        'Xor IfColor Import UserVar SetSimMode Global EndScript ExitScript RestartScript Delay VBSBegin VBSEnd Lib LibE Alias Declare Plugin ' +
        'Abs Array Asc Atn CBool CByte CCur CDate CDbl CInt CLng CSng CStr Chr Cos CreateObject Date DateAdd DateDiff DatePart DateSerial DateValue Day Escape '+
        'Eval Exp Filter Fix FormatCurrency FormatDateTime FormatNumber FormatPercent GetLocale GetObject GetRef Hex Hour InStr InStrRev InputBox Int IsArray '+
        'IsDate IsEmpty IsNull IsNumeric IsObject Join LBound LCase LTrim Left Len LoadPicture Log Mid Minute Month MonthName MsgBox Now Oct Randomize RGB RTrim '+
        'Replace Right Rnd Round ScriptEngine ScriptEngineBuildVersion ScriptEngineMajorVersion ScriptEngineMinorVersion Second SetLocale Sgn Sin Space Split Sqr '+
        'StrComp StrReverse String Tan Time TimeSerial TimeValue Timer Trim TypeName UBound UCase Unescape VarType Weekday WeekdayName Year KeyGroup KeyPress '+
        'KeyPressH KeyPressS KeyDown KeyDownH KeyDownS KeyUp KeyUpH KeyUpS WaitKey GetLastKey LeftClick LeftClickH LeftClickS LeftDoubleClick LeftDoubleClickH '+
        'LeftDoubleClickS LeftDown LeftDownH LeftDownS LeftUp LeftUpH LeftUpS RightClick RightClickH RightClickS RightDown RightDownH RightDownS RightUp '+
        'RightUpH RightUpS MiddleClick MiddleClickH MiddleClickS MoveTo MoveToH MoveToS MoveR MoveRH MoveRS MouseWheel SaveMousePos RestoreMousePos LockMouse '+
        'UnlockMouse WaitClick GetLastClick GetCursorPos GetCursorShape GetPixelColor FindColor FindColorEx FindCenterColor FindPic GetMacroID SayString '+
        'MessageBox RunApp PutAttachment TracePrint LogStart LogStop BeginThread StopThread PauseThread ContinueThread GetThreadID SetEnv GetEnv Beep Execute '+
        'GetExeDir GetScreenResolution ExecuteGlobal QMLibrary QUIMethodObj '+
        'Bkgnd BkgndColor Color Console Encrypt File GetSysInfo Media Memory Msg Net Office Pic Sys SysEx Web Window SMWH SmIE SmADO SmVM SmWeb SmReg SmOCR Access Oracle SQLServer MySql SGuoBrowser';
        this.regexList = [
            { regex: new RegExp('(//|\').*$', 'gm'), css: 'comment' }, 
            { regex: dp.sh.RegexLib.DoubleQuotedString, css: 'string' }, 
            { regex: new RegExp(this.GetKeywords('dm'), 'gm'), css: 'preprocessor' }, 
            { regex: new RegExp(this.GetKeywords(keywords), 'gm'), css: 'keyword'}
        ]; 
        this.CssClass = 'dp-vb'; 
    }
    dp.sh.Brushes.Vb.prototype = new dp.sh.Highlighter(); dp.sh.Brushes.Vb.Aliases = ['vb', 'vb.net'];
    dp.SyntaxHighlighter.ClipboardSwf = "http://www.vrbrothers.com/cn/qmacro/qmdn/htmls/zh_chs/qm/scripts/clipboard.swf";
    dp.SyntaxHighlighter.HighlightAll('code8__初始化',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_读写锁创建',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_读写锁读锁定',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_读写锁解锁',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_读写锁销毁',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_读写锁写锁定',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_互斥锁创建',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_互斥锁进入',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_互斥锁退出',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_互斥锁销毁',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_临界区创建',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_临界区进入',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_临界区退出',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_临界区销毁',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_事件创建',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_事件进入',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_事件退出',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_事件销毁',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_线程_挂起',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_线程_恢复',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_线程_结束',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_线程_取当前ID',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_线程_取状态',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_信号量创建',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_信号量等待',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_信号量是否空闲',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_信号量释放',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_信号量销毁',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_初始化',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_递减',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_递增',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_调试输出',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_赋值',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_交换',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_三目运算',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_销毁',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_原子_运算',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_自旋锁创建',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_自旋锁进入',true,true,false);
    dp.SyntaxHighlighter.HighlightAll('code8_自旋锁退出',true,true,false);

</script>
</body>
</html>	

